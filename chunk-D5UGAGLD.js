import{a as z,b as U,c as v,d as A,e as G,f as O,g as j,h as B,i as L,j as J,k as K,l as Q}from"./chunk-CTWLBV5P.js";import{B as M,G as I,H as T,Ia as P,Ka as q,Q as V,Qa as R,R as l,S as H,Ta as k,Y as p,_ as m,fa as i,ga as t,ha as g,ka as D,la as f,ma as _,ua as a,xa as N,z as w}from"./chunk-HEL3WMYV.js";function W(r,u){if(r&1){let s=D();i(0,"div",28),g(1,"img",29),i(2,"button",30),f("click",function(){I(s);let n=_();return T(n.removeImage("image"))}),a(3,"Remove"),t()()}if(r&2){let s=_();l(),m("src",s.imagePreviews.image,V)}}function X(r,u){r&1&&(i(0,"div",31),a(1," Imagem-Capa \xE9 obrigat\xF3ria. "),t())}function Y(r,u){if(r&1){let s=D();i(0,"div",28),g(1,"img",29),i(2,"button",30),f("click",function(){I(s);let n=_();return T(n.removeImage("carousel1"))}),a(3,"Remove"),t()()}if(r&2){let s=_();l(),m("src",s.imagePreviews.carousel1,V)}}function Z(r,u){r&1&&(i(0,"div",31),a(1," Carrosel-1 \xE9 obrigat\xF3rio. "),t())}function $(r,u){if(r&1){let s=D();i(0,"div",28),g(1,"img",29),i(2,"button",30),f("click",function(){I(s);let n=_();return T(n.removeImage("carousel2"))}),a(3,"Remove"),t()()}if(r&2){let s=_();l(),m("src",s.imagePreviews.carousel2,V)}}function ee(r,u){r&1&&(i(0,"div",31),a(1," Carrosel-2 \xE9 obrigat\xF3rio. "),t())}function te(r,u){if(r&1){let s=D();i(0,"div",28),g(1,"img",29),i(2,"button",30),f("click",function(){I(s);let n=_();return T(n.removeImage("carousel3"))}),a(3,"Remove"),t()()}if(r&2){let s=_();l(),m("src",s.imagePreviews.carousel3,V)}}function ne(r,u){r&1&&(i(0,"div",31),a(1," Carrosel-3 \xE9 obrigat\xF3rio. "),t())}function ie(r,u){r&1&&(i(0,"div",31),a(1," Hist\xF3rico \xE9 obrigat\xF3rio. "),t())}function re(r,u){r&1&&(i(0,"div",31),a(1," Endere\xE7o \xE9 obrigat\xF3rio. "),t())}function oe(r,u){r&1&&(i(0,"div",31),a(1," Entrada \xE9 obrigat\xF3ria. "),t())}function ae(r,u){r&1&&(i(0,"div",31),a(1," Hor\xE1rio de Funcionamento \xE9 obrigat\xF3rio. "),t())}function le(r,u){r&1&&(i(0,"div",31),a(1," O t\xEDtulo do card \xE9 obrigat\xF3rio. "),t())}function me(r,u){r&1&&(i(0,"div",31),a(1," Descri\xE7\xE3o do card \xE9 obrigat\xF3ria. "),t())}var he=(()=>{let u=class u{constructor(o){this.fb=o,this.monumentoService=w(z),this.notificacaoService=w(K),this.cardService=w(Q),this.router=w(R),this.imagePreviews={},this.monumentForm=this.fb.group({image:[null,v.required],carousel1:[null,v.required],carousel2:[null,v.required],carousel3:[null,v.required],history:["",v.required],address:["",v.required],entryFee:["",v.required],openingHours:["",v.required],titulo:["",v.required],descricao:["",v.required]})}onSubmit(){if(!this.monumentForm.valid)return;let o=this.collectMonumentFormData();this.monumentoService.createMonumento(o).subscribe({next:n=>{this.handleMonumentCreationSuccess(n)},error:n=>{console.error("Error:",n)}})}collectMonumentFormData(){let o=this.monumentForm.value,n=new FormData;return n.append("id","0"),n.append("history",o.history),n.append("address",o.address),n.append("openingHours",o.openingHours),n.append("entryFee",o.entryFee),n.append("carousel1",o.carousel1),n.append("carousel2",o.carousel2),n.append("carousel3",o.carousel3),n.append("image",o.image),n}handleMonumentCreationSuccess(o){let n=this.prepareCardFormData(o);this.cardService.createCard(n).subscribe({next:e=>{this.handleCardCreationSuccess()},error:e=>{console.error("Error creating card:",e)}})}prepareCardFormData(o){let n=this.monumentForm.value,e=new FormData;return e.append("descricao",n.descricao),e.append("titulo",n.titulo),e.append("imagem",n.image),e.append("monumentoId",o.id),e}handleCardCreationSuccess(){this.notificacaoService.show({text:"Cadastro Realizado com sucesso",classname:"bg-success text-light",delay:2e3}),this.router.navigate(["/"])}onFileChange(o,n){let e=o.target.files?.[0];if(e){this.monumentForm.patchValue({[n]:e}),this.monumentForm.get(n)?.updateValueAndValidity();let d=new FileReader;d.onload=()=>{d.result&&(this.imagePreviews[n]=d.result)},d.readAsDataURL(e),console.log(this.monumentForm)}}removeImage(o){this.monumentForm.patchValue({[o]:null}),this.monumentForm.get(o)?.updateValueAndValidity(),delete this.imagePreviews[o];let n=document.getElementById(o);n&&(n.value="")}};u.\u0275fac=function(n){return new(n||u)(H(L))},u.\u0275cmp=M({type:u,selectors:[["app-cadastrar"]],standalone:!0,features:[N],decls:65,vars:16,consts:[[1,"container","mt-5"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6"],[1,"mb-3"],["for","image",1,"form-label"],["type","file","id","image",1,"form-control",3,"change"],["class","mt-2",4,"ngIf"],["class","text-danger",4,"ngIf"],["for","carousel1",1,"form-label"],["type","file","id","carousel1",1,"form-control",3,"change"],["for","carousel2",1,"form-label"],["type","file","id","carousel2",1,"form-control",3,"change"],["for","carousel3",1,"form-label"],["type","file","id","carousel3",1,"form-control",3,"change"],["for","history",1,"form-label"],["id","history","rows","3","formControlName","history",1,"form-control"],["for","address",1,"form-label"],["type","text","id","address","formControlName","address",1,"form-control"],["for","entryFee",1,"form-label"],["type","text","id","entryFee","formControlName","entryFee",1,"form-control"],["for","openingHours",1,"form-label"],["id","openingHours","rows","3","formControlName","openingHours",1,"form-control"],[1,"mt-3"],["type","text","id","titulo","formControlName","titulo",1,"form-control"],["for","descricao",1,"form-label"],["id","descricao","rows","3","formControlName","descricao",1,"form-control"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"mt-2"],[1,"img-thumbnail",2,"max-height","100px",3,"src"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"text-danger"]],template:function(n,e){if(n&1&&(i(0,"div",0)(1,"h1"),a(2,"Cadastro do Monumento"),t(),i(3,"form",1),f("ngSubmit",function(){return e.onSubmit()}),i(4,"div",2)(5,"div",3)(6,"div",4)(7,"label",5),a(8,"Imagem-Capa:"),t(),i(9,"input",6),f("change",function(c){return e.onFileChange(c,"image")}),t(),p(10,W,4,1,"div",7)(11,X,2,0,"div",8),t(),i(12,"div",4)(13,"label",9),a(14,"Carrosel-1:"),t(),i(15,"input",10),f("change",function(c){return e.onFileChange(c,"carousel1")}),t(),p(16,Y,4,1,"div",7)(17,Z,2,0,"div",8),t(),i(18,"div",4)(19,"label",11),a(20,"Carrosel-2:"),t(),i(21,"input",12),f("change",function(c){return e.onFileChange(c,"carousel2")}),t(),p(22,$,4,1,"div",7)(23,ee,2,0,"div",8),t(),i(24,"div",4)(25,"label",13),a(26,"Carrosel-3:"),t(),i(27,"input",14),f("change",function(c){return e.onFileChange(c,"carousel3")}),t(),p(28,te,4,1,"div",7)(29,ne,2,0,"div",8),t(),i(30,"div",4)(31,"label",15),a(32,"Hist\xF3rico do Monumento:"),t(),g(33,"textarea",16),p(34,ie,2,0,"div",8),t()(),i(35,"div",3)(36,"div",4)(37,"label",17),a(38,"Endere\xE7o:"),t(),g(39,"input",18),p(40,re,2,0,"div",8),t(),i(41,"div",4)(42,"label",19),a(43,"Entrada:"),t(),g(44,"input",20),p(45,oe,2,0,"div",8),t(),i(46,"div",4)(47,"label",21),a(48,"Hor\xE1rio de Funcionamento:"),t(),g(49,"textarea",22),p(50,ae,2,0,"div",8),t(),i(51,"h3",23),a(52,"Informa\xE7\xF5es do Card:"),t(),i(53,"div",4)(54,"label",19),a(55,"T\xEDtulo:"),t(),g(56,"input",24),p(57,le,2,0,"div",8),t(),i(58,"div",4)(59,"label",25),a(60,"Descri\xE7\xE3o:"),t(),g(61,"textarea",26),p(62,me,2,0,"div",8),t()()(),i(63,"button",27),a(64,"Cadastrar"),t()()()),n&2){let d,c,C,F,h,E,y,b,S,x;l(3),m("formGroup",e.monumentForm),l(7),m("ngIf",e.imagePreviews.image),l(),m("ngIf",((d=e.monumentForm.get("image"))==null?null:d.invalid)&&(((d=e.monumentForm.get("image"))==null?null:d.dirty)||((d=e.monumentForm.get("image"))==null?null:d.touched))),l(5),m("ngIf",e.imagePreviews.carousel1),l(),m("ngIf",((c=e.monumentForm.get("carousel1"))==null?null:c.invalid)&&(((c=e.monumentForm.get("carousel1"))==null?null:c.dirty)||((c=e.monumentForm.get("carousel1"))==null?null:c.touched))),l(5),m("ngIf",e.imagePreviews.carousel2),l(),m("ngIf",((C=e.monumentForm.get("carousel2"))==null?null:C.invalid)&&(((C=e.monumentForm.get("carousel2"))==null?null:C.dirty)||((C=e.monumentForm.get("carousel2"))==null?null:C.touched))),l(5),m("ngIf",e.imagePreviews.carousel3),l(),m("ngIf",((F=e.monumentForm.get("carousel3"))==null?null:F.invalid)&&(((F=e.monumentForm.get("carousel3"))==null?null:F.dirty)||((F=e.monumentForm.get("carousel3"))==null?null:F.touched))),l(5),m("ngIf",((h=e.monumentForm.get("history"))==null?null:h.invalid)&&(((h=e.monumentForm.get("history"))==null?null:h.dirty)||((h=e.monumentForm.get("history"))==null?null:h.touched))),l(6),m("ngIf",((E=e.monumentForm.get("address"))==null?null:E.invalid)&&(((E=e.monumentForm.get("address"))==null?null:E.dirty)||((E=e.monumentForm.get("address"))==null?null:E.touched))),l(5),m("ngIf",((y=e.monumentForm.get("entryFee"))==null?null:y.invalid)&&(((y=e.monumentForm.get("entryFee"))==null?null:y.dirty)||((y=e.monumentForm.get("entryFee"))==null?null:y.touched))),l(5),m("ngIf",((b=e.monumentForm.get("openingHours"))==null?null:b.invalid)&&(((b=e.monumentForm.get("openingHours"))==null?null:b.dirty)||((b=e.monumentForm.get("openingHours"))==null?null:b.touched))),l(7),m("ngIf",((S=e.monumentForm.get("titulo"))==null?null:S.invalid)&&(((S=e.monumentForm.get("titulo"))==null?null:S.dirty)||((S=e.monumentForm.get("titulo"))==null?null:S.touched))),l(5),m("ngIf",((x=e.monumentForm.get("descricao"))==null?null:x.invalid)&&(((x=e.monumentForm.get("descricao"))==null?null:x.dirty)||((x=e.monumentForm.get("descricao"))==null?null:x.touched))),l(),m("disabled",e.monumentForm.invalid)}},dependencies:[J,O,U,A,G,j,B,q,P,k],styles:[".img-thumbnail[_ngcontent-%COMP%]{max-height:100px}.btn-sm[_ngcontent-%COMP%]{margin-left:10px;margin-top:10px}"]});let r=u;return r})();export{he as CadastrarComponent};
